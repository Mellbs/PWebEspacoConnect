<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login - Agendamento de Salas</title>
    <link rel="icon" href="images/logo - Copia.png" type="image/png">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="../agendamento-salas/lib/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>

<body class="login">
    <div class="row" style="width: 100%;">
        <div class="col-md-6">
            <img src="../agendamento-salas/images/calendar.png" alt="Foto da tela inicial">
        </div>
        <div class="col-md-4">
            <div class="container container-index">
                <h2 style="color: #004aad; font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif; font-weight: bold;">AGENDAMENTO DE SALAS</h2>
                <form id="form-login" style="color: #004aad; font-weight: bold;">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required>

                    <label for="senha">Senha</label>
                    <input type="password" id="senha" name="senha" required>
                    <span id="login-error" style="color: red;"></span>

                    <div class="extra">
                        <a href="esqueceu-senha.html">Esqueceu a senha?</a>
                    </div>
                    <br>
                    <button type="submit" style="font-weight: bold;">Entrar</button>
                </form>
                <div class="register" style="font-weight: bold;">
                    <span>Não tem uma conta?</span>
                    <a href="cadastro.html">Cadastre-se</a>
                </div>
            </div>
        </div>
    </div>

    <div class="ajuda" data-toggle="modal" data-target="#ajudaModal">
        <i class="fas fa-question-circle" style="font-size: 36px;"></i>
    </div>

    <div class="modal fade" id="ajudaModal" tabindex="-1" role="dialog" aria-labelledby="ajudaModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="ajudaModalLabel" style="font-weight: bold;">Não consegue acessar sua conta?</h5>
                </div>
                <div class="modal-body">
                    <p>Se você está tendo dificuldades para acessar sua conta no Espaço Connect, estamos aqui para ajudar!</p>
                    <h6 style="font-weight: bold; color: #004aad;">Dicas para resolver problemas comuns:</h6>
                    <ul>
                        <li>Certifique-se de que seu login e senha estão corretos. Senhas são case-sensitive.</li>
                        <li>Verifique se o Caps Lock está ativado ou desativado.</li>
                        <li>Se você esqueceu sua senha, clique em "Esqueceu a senha?" e siga as instruções.</li>
                        <li>Certifique-se de que sua conexão com a internet está estável.</li>
                    </ul>
                    <h6 style="font-weight: bold; color: #004aad;">Ainda está tendo problemas?</h6>
                    <p>Entre em contato conosco pelo e-mail <a href="mailto:suporte@espacoconnect.com">suporte@espacoconnect.com</a> ou pelo telefone (11)96933-1586.</p>
                    <h6 style="font-weight: bold; color: #004aad;">Segurança da sua conta:</h6>
                    <p>Mantenha suas credenciais de login seguras e nunca as compartilhe.</p>
                    <p>Atenciosamente,</p>
                    <p>Equipe Espaço Connect</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary btn-lg" data-dismiss="modal"
                        style="background-color: #004aad; font-weight: bold;">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#form-login').submit(function(e) {
                e.preventDefault();
                $.ajax({
                    type: 'POST',
                    url: '../api/auth/login.php',
                    data: $(this).serialize(),
                    dataType: 'json',
                    success: function(response) {
                        if (response.status === 'success') {
                            localStorage.setItem('usuario', JSON.stringify(response.usuario));
                            if (response.usuario.papel === 'gerente') {
                                window.location.href = 'admin/tela-inicial_admin.html';
                            } else {
                                window.location.href = 'tela-inicial.html';
                            }
                        } else {
                            $('#login-error').text(response.mensagem);
                            setTimeout(() => {
                                $('#login-error').text('');
                            }, 1000);
                        }
                    },
                    error: function(xhr, status, error) {
                        console.error("AJAX Error: " + status + " - " + error);
                        $('#login-error').text('Erro ao conectar com o servidor.');
                    }
                });
            });
        });
    </script>
</body>

</html>